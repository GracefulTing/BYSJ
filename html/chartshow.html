<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>form</title>
    <style>
        #container{
            border:1px solid;
            margin:10px auto;
        }
        #box{
            border:1px solid;
            margin:500px auto;
        }
    </style>
</head>
<body>
    <div id="container" style="width:580px; height: 400px;">
    <div id="box" style="width:580px;height:400px;"></div>
</body>
<script src="https://cdn.bootcss.com/echarts/4.0.4/echarts.min.js"></script>
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script>
    var state = [],weight = [];
 
    //调用ajax来实现异步的加载数据
    function getusers() {
        $.ajax({
            type: "post",
            async: false,
            url: "../php/code/selectData.php",
            data: {},
            dataType: "json",
            success: function(result){
                if(result){
                    for(var i = 0 ; i < result.length; i++){
                        state.push(result[i].state);
                        weight.push(result[i].weight);
                    }
                }
            },
             error: function(errmsg) {
                alert("Ajax获取服务器数据出错了！"+ errmsg);
            }
        });
        return state,weight;
    }
 
    // 执行异步请求
    getusers();
 
 
    var mychart = echarts.init(document.getElementById("container"));
    var option = {
        tooltip: {
            trigger: 'item',
            formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        toolbox: {
                show: true,
                feature: {
                    dataView: {readOnly: true},
                    // restore: {},
                    saveAsImage: {
                        title:"保存为png"
                    }
                },
                orient:"vertical",
                right:20,
                top:"middle",
                itemSize:20,
                itemGap:30
            },
        legend: {
            orient: 'vertical',
            left: 'left',
            data: ['健康指数']
        },
        series: [{
            name: '饼图二',
            type: 'pie',
            radius: ['50%', '60%'],
            label: {
                normal: {
                    position: 'center'
                }
            },
            data: [{
                value: 60,
                name:'健康指数',
                label: {
                    normal: {
                        formatter: '{d} %',
                        textStyle: {
                            fontSize: 40
                        }
                    }
                }
            }, {
                value: 40,
                name: state,
                label: {
                    normal: {
                        formatter: state,
                        textStyle: {
                            color: '#555',
                            fontSize: 30
                        }
                    }
                },
                tooltip: {
                    show: false
                },
                itemStyle: {
                    normal: {
                        color: '#aaa'
                    },
                    emphasis: {
                        color: '#aaa'
                    }
                },
                hoverAnimation: false
            }]
        }]
    };
     mychart.setOption(option);


     //指定图标的配置和数据
        var  option = {
            fontFamily: 'Roboto',
            name: '体重',
            toolbox: {
                show: true,
                feature: {
                    dataView: {readOnly: true},
                    // restore: {},
                    saveAsImage: {
                        title:"保存为png"
                    }
                },
                orient:"vertical",
                right:20,
                top:"middle",
                itemSize:20,
                itemGap:30
            },
            backgroundColor: '#82d7f3',
            title: {
                text: '79kg', //最近一次体重
                subtext: '      体重',
                textStyle: {
                    fontWeight: 'bolder',
                    fontSize: 48,
                    color: '#FFFFFF',
                },
                subtextStyle: {
                    fontWeight: 'bolder',
                    fontSize: 24,
                    color: '#0099ff',
                },
                right: '0%',
                top: '0%'
            },
            dataZoom: [{ // 这个dataZoom组件，默认控制x轴。
                type: 'slider', // 这个 dataZoom 组件是 slider 型 dataZoom 组件
                start: 50, // 左边在 10% 的位置。
                end: 100 // 右边在 60% 的位置。
            }],
            grid: {
                left: '5%',
                right: '10%',
                bottom: '5%',
                containLabel: true
            },
            xAxis: [{
                type: 'category',
                boundaryGap: false,
                data: ['9.23', '10.3', '10.11', '10.15', '10.26', '12.26'],
                axisLabel: {
                    show: true,
                    interval: 0,
                    fontSize: 20,
                    color: '#ffffff',
                    fontWeight: 'bold'
                },
                axisLine: {
                    show: false
                },
                axisTick: {
                    show: false
                },
            }],
            yAxis: [{
                show: false,
                min: 76, //最低为临近BMI线减3
                max: 85, //最高为临近BMI线加3或最高值加3
            }],
            series: [{
                name: '体重',
                type: 'line',
                smooth: true,
                symbol: 'circle',
                showSymbol: true,
                lineStyle: {
                    normal: {
                        width: 5,
                        color: '#0099ff',
                        shadowBlur: 6,
                        shadowColor: 'rgba(0, 0, 0, 0.2)',
                        shadowOffsetY: 8,
                    }
                },
                areaStyle: {
                    normal: {
                        color: new echarts.graphic.LinearGradient(1, 1, 1, 0, [{
                            offset: 0,
                            color: 'rgba(58,191,238, 1)'
                        }, {
                            offset: 1,
                            color: 'rgba(58,191,238, 0.3)'
                        }]),
                    },
                },
                itemStyle: {
                    normal: {
                        color: '#0099ff',
                        borderColor: '#ffffff',
                        borderWidth: 12,
                    }
                },
                label: {
                    normal: {
                        show: true,
                        position: 'top',
                        color: '#ffffff',
                        fontSize: 24,
                    },
                },
                markLine: {
                    //体质指数（BMI）=体重（kg）÷身高^2（m）
                    //BMI指数过轻：低于18.5
                    //正常：18.5-23.9
                    //过重：24-27
                    //肥胖：28-32
                    //非常肥胖, 高于32
                    lineStyle: {
                        normal: {
                            color: 'rgba(0,0,0,0.3)',
                        },
                    },
                    data: [{
                        name: '超胖32',
                        label: {
                            normal: {
                                formatter: '超胖 90kg',
                                position: 'middle',
                                fontSize: 18,
                            }
                        },
                        yAxis: 85, //体质指数（BMI32）=体重（kg）÷身高^2（m）
                    }, {
                        name: '肥胖28',
                        label: {
                            normal: {
                                formatter: '肥胖 85kg',
                                position: 'middle',
                                fontSize: 18,
                            }
                        },
                        yAxis: 80, //体质指数（BMI）28=体重（kg）÷身高^2（m）
                    }, {
                        name: '过重24',
                        label: {
                            normal: {
                                formatter: '过重 80kg',
                                position: 'middle',
                                fontSize: 18,
                            }
                        },
                        yAxis: 75, //体质指数（BMI）24=体重（kg）÷身高^2（m）
                    }, {
                        name: '正常18.5',
                        label: {
                            normal: {
                                formatter: '正常 65kg',
                                position: 'middle',
                                fontSize: 18,
                            }
                        },
                        yAxis: 70, //体质指数（BMI）18.5=体重（kg）÷身高^2（m）
                    }]
                },
                data: [83, 82, 80, 83, 80, 79]
            }, ]
        };
        //初始化echarts实例
        var myChart = echarts.init(document.getElementById('box'));
        //使用制定的配置项和数据显示图表
        myChart.setOption(option);
</script>
</html>
